<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TODO</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/1.5.4/peerjs.min.js"></script>

  <script src="util.js"></script>
  <script src="lm.js"></script>

  <script src="profile.js"></script>

  <script src="demo/input.js"></script>

  <script src="p2pnode.js"></script>
  <script src="p2pnode.view.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dexie/3.2.4/dexie.min.js"></script>

  <script src="store.js"></script>
  <script src="todo.js"></script>

  <link href="todo.css" rel="stylesheet"/>

</head>
<body>

<div class="container">
  <div id="todolist"></div>
  <div id="net">
    <node-status-view></node-status-view>
    <bootstrap-discovery-view></bootstrap-discovery-view>
    <send-message-view></send-message-view>
    <network-messages-view></network-messages-view>
    <network-log-view></network-log-view>
  </div>
</div>

<script>

  const todo = new TodoList(document.getElementById('todolist'));

  const node = new P2PNode();


  document.querySelector('node-status-view').nodeReference =
  document.querySelector('bootstrap-discovery-view').nodeReference =
  document.querySelector('send-message-view').nodeReference =
  document.querySelector('network-messages-view').nodeReference =
  document.querySelector('network-log-view').nodeReference =
    node;

  // // Handle incoming messages to add to the todo list
  // node.addEventListener('message-received', e => {
  //   const { message } = e.detail;
  //   if (message.content && message.sender !== node.peerId) {
  //     todo.addItem(message.content);
  //   }
  // });
  //
  // // Broadcast new todo items to peers
  // const originalAddItem = todo.addItem.bind(todo);
  // todo.addItem = async function(text) {
  //   await originalAddItem(text);
  //   node.broadcast(text);
  // };

  //todo.update(node); //sync

</script>
</body>
</html>
